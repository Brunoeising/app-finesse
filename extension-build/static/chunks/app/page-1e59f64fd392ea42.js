(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2480:function(){},160:function(e,t,s){Promise.resolve().then(s.bind(s,2624))},2624:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return F}});var r,a,o=s(7437),i=s(2265);let n=[{id:{text:"1"},label:{text:"Pausa - Almo\xe7o"},category:"NOT_READY"},{id:{text:"2"},label:{text:"Pausa - Banheiro"},category:"NOT_READY"},{id:{text:"3"},label:{text:"Pausa - Caf\xe9"},category:"NOT_READY"},{id:{text:"4"},label:{text:"Pausa - Reuni\xe3o"},category:"NOT_READY"},{id:{text:"5"},label:{text:"Pausa - Treinamento"},category:"NOT_READY"},{id:{text:"6"},label:{text:"Pausa - Suporte T\xe9cnico"},category:"NOT_READY"},{id:{text:"7"},label:{text:"Pausa - Atividade Administrativa"},category:"NOT_READY"},{id:{text:"8"},label:{text:"Pausa - Fim de Expediente"},category:"NOT_READY"},{id:{text:"9"},label:{text:"Pausa - Problema T\xe9cnico"},category:"NOT_READY"},{id:{text:"10"},label:{text:"Pausa - Atendimento Interno"},category:"NOT_READY"}];class l{checkLimit(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",s=Date.now(),r="".concat(e,":").concat(t),a=this.requests.get(r)||[];return(a=a.filter(e=>s-e.timestamp<this.windowMs)).length>=this.maxRequests?(console.warn("Rate limit excedido para ".concat(e,":").concat(t,". ").concat(a.length,"/").concat(this.maxRequests," requisi\xe7\xf5es em ").concat(this.windowMs/1e3,"s")),!1):(a.push({timestamp:s,endpoint:t}),this.requests.set(r,a),console.log("Rate limit OK para ".concat(e,":").concat(t,". ").concat(a.length,"/").concat(this.maxRequests," requisi\xe7\xf5es")),!0)}getStats(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",s=Date.now(),r="".concat(e,":").concat(t),a=this.requests.get(r)||[],o=(a=a.filter(e=>s-e.timestamp<this.windowMs))[0],i=o?Math.max(0,this.windowMs-(s-o.timestamp)):0;return{current:a.length,max:this.maxRequests,remaining:Math.max(0,this.maxRequests-a.length),resetIn:Math.ceil(i/1e3)}}cleanup(){let e=Date.now(),t=[];Array.from(this.requests.entries()).forEach(s=>{let[r,a]=s,o=a.filter(t=>e-t.timestamp<this.windowMs);0===o.length?t.push(r):this.requests.set(r,o)}),t.forEach(e=>this.requests.delete(e))}resetUser(e){let t=[];Array.from(this.requests.keys()).forEach(s=>{s.startsWith("".concat(e,":"))&&t.push(s)}),t.forEach(e=>this.requests.delete(e))}isNearLimit(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.8,r=this.getStats(e,t);return r.current/r.max>=s}getTimeToReset(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";return this.getStats(e,t).resetIn}destroy(){this.cleanupInterval&&(clearInterval(this.cleanupInterval),this.cleanupInterval=null),this.requests.clear()}getConfig(){return{maxRequests:this.maxRequests,windowMs:this.windowMs,windowSeconds:Math.floor(this.windowMs/1e3)}}constructor(){this.requests=new Map,this.maxRequests=parseInt("5"),this.windowMs=parseInt("60000"),this.cleanupInterval=setInterval(()=>this.cleanup(),3e5)}}let c=new l;class d{async makeRequestWithRateLimit(e,t,s){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"api";if(!c.checkLimit(s,r)){let e=c.getStats(s,r);throw Error("Rate limit excedido. Tente novamente em ".concat(e.resetIn," segundos."))}return this.makeRequest(e,t)}validateEmailDomain(e){return this.allowedDomains.some(t=>e.toLowerCase().endsWith(t.toLowerCase()))}validateCredentials(e){return e.username&&e.username.includes("@")?this.validateEmailDomain(e.username)?/^\d{2}\.\d{3}\.\d{3}$/.test(e.agentId)?!e.password||e.password.length<4?{valid:!1,error:"Senha deve ter pelo menos 4 caracteres"}:{valid:!0}:{valid:!1,error:"Formato de Agent ID inv\xe1lido (ex: 99.999.999)"}:{valid:!1,error:"Dom\xednio de email n\xe3o autorizado"}:{valid:!1,error:"Email inv\xe1lido"}}createAuthHeader(e,t){try{return btoa("".concat(e,":").concat(t))}catch(e){throw Error("Erro ao criar header de autentica\xe7\xe3o")}}async makeRequest(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=new AbortController,a=setTimeout(()=>r.abort(),this.requestTimeout);try{let s=await fetch(e,{...t,signal:r.signal});return clearTimeout(a),s}catch(r){if(clearTimeout(a),0===s&&r instanceof Error&&"AbortError"===r.name)return await new Promise(e=>setTimeout(e,1e3)),this.makeRequest(e,t,1);throw r}}parseXmlToJson(e){try{let t=e.trim();if(!t.startsWith("<"))throw Error("Resposta n\xe3o \xe9 um XML v\xe1lido");return this.parseXml(t)}catch(e){throw console.error("Erro no parse do XML:",e),Error("Falha ao processar resposta do servidor")}}parseXml(e){let t;let s={},r=/<([\w:.-]+)[^>]*>.*?<\/\1>/g;for(;null!==(t=r.exec(e));){let e=this.parseNode(t[0]),r=e.tagName;delete e.tagName,s[r]?(Array.isArray(s[r])||(s[r]=[s[r]]),s[r].push(e)):s[r]=e}return s}parseNode(e){let t={},s=e.match(/<([\w:.-]+)([^>]*)>/);if(s){let r;let a=s[1];t.tagName=a;let o=s[2],i=/([\w:.-]+)="([^"]*)"/g;for(;null!==(r=i.exec(o));)t[r[1]]=r[2];let n=e.replace(/<[\w:.-]+[^>]*>|<\/[\w:.-]+>/g,"");n.trim()&&(/<[\w:.-]+[^>]*>/.test(n)?t.children=this.parseXml(n):t.text=n.trim())}return t}async connectApi(e){let t=this.validateCredentials(e);if(!t.valid)return{success:!1,error:t.error||"Credenciais inv\xe1lidas"};let{username:s,password:r,agentId:a}=e,o=this.createAuthHeader(s,r),i="".concat(s,":").concat(a);console.log("Tentando conectar com Finesse...");let n=await this.tryConnectionWithRateLimit(this.baseUrl,a,o,i);return n.success||this.fallbackUrl===this.baseUrl||(console.log("Tentando servidor de fallback..."),n=await this.tryConnectionWithRateLimit(this.fallbackUrl,a,o,i)),n}async tryConnectionWithRateLimit(e,t,s,r){try{let i=t.replace(/\./g,""),n="".concat(e,"/User/").concat(i,"/");console.log("Conectando com: ".concat(n));let l=await this.makeRequestWithRateLimit(n,{method:"GET",headers:{Authorization:"Basic ".concat(s),Accept:"application/xml"}},r,"user-status");if(console.log("Status da resposta: ".concat(l.status)),!l.ok){if(401===l.status)return{success:!1,error:"Credenciais inv\xe1lidas ou n\xe3o autorizadas"};if(404===l.status)return{success:!1,error:"Agent ID n\xe3o encontrado no sistema"};if(415===l.status)return{success:!1,error:"Erro de configura\xe7\xe3o do servidor (415)"};return{success:!1,error:"Erro do servidor: ".concat(l.status)}}let c=await l.text();if(!c)return{success:!1,error:"Resposta vazia do servidor"};let d=this.parseXmlToJson(c);if(d.ApiErrors){var a,o;return{success:!1,error:(null===(o=d.ApiErrors.ApiError)||void 0===o?void 0:null===(a=o.ErrorMessage)||void 0===a?void 0:a.text)||"Erro na API do Finesse"}}return{success:!0,data:d}}catch(e){if(console.error("Erro na conex\xe3o com Finesse:",e),e instanceof Error&&e.message.includes("Rate limit"))return{success:!1,error:e.message};return{success:!1,error:e instanceof Error?e.message:"Erro de conex\xe3o"}}}async changeAgentState(e,t,s){let r;let a=this.validateCredentials(e);if(!a.valid)return{success:!1,error:a.error};let{username:o,password:i,agentId:n}=e,l=this.createAuthHeader(o,i),c="".concat(o,":").concat(n);if("NOT_READY"===t&&s)r="<User><state>".concat(t,"</state><reasonCodeId>").concat(s,"</reasonCodeId></User>");else{if("READY"!==t)return{success:!1,error:"Estado inv\xe1lido ou c\xf3digo de motivo obrigat\xf3rio"};r="<User><state>".concat(t,"</state></User>")}let d=await this.tryStateChangeWithRateLimit(this.baseUrl,n,l,r,c);return d.success||this.fallbackUrl===this.baseUrl||(d=await this.tryStateChangeWithRateLimit(this.fallbackUrl,n,l,r,c)),d}async tryStateChangeWithRateLimit(e,t,s,r,a){try{let n=t.replace(/\./g,""),l="".concat(e,"/User/").concat(n,"/"),c=await this.makeRequestWithRateLimit(l,{method:"PUT",headers:{Authorization:"Basic ".concat(s),"Content-Type":"application/xml",Accept:"application/xml"},body:r},a,"state-change");if(!c.ok){if(401===c.status)return{success:!1,error:"N\xe3o autorizado"};if(409===c.status)return{success:!1,error:"Estado n\xe3o pode ser alterado no momento"};return{success:!1,error:"Erro ao alterar status: ".concat(c.status)}}let d=await c.text(),u=this.parseXmlToJson(d);if(u.ApiErrors){var o,i;return{success:!1,error:(null===(i=u.ApiErrors.ApiError)||void 0===i?void 0:null===(o=i.ErrorMessage)||void 0===o?void 0:o.text)||"Erro na altera\xe7\xe3o do estado"}}return{success:!0,data:u}}catch(e){if(console.error("Erro na altera\xe7\xe3o do estado:",e),e instanceof Error&&e.message.includes("Rate limit"))return{success:!1,error:e.message};return{success:!1,error:e instanceof Error?e.message:"Erro de conex\xe3o"}}}async getReasonCodes(e){let t=this.validateCredentials(e);if(!t.valid)return{success:!1,error:t.error};let{username:s,password:r,agentId:a}=e,o=this.createAuthHeader(s,r),i="".concat(s,":").concat(a),l=await this.tryGetReasonCodesWithRateLimit(this.baseUrl,o,i);return(l.success||this.fallbackUrl===this.baseUrl||(l=await this.tryGetReasonCodesWithRateLimit(this.fallbackUrl,o,i)),l.success)?l:(console.log("API falhou - usando c\xf3digos de motivo padr\xe3o"),{success:!0,data:n})}async tryGetReasonCodesWithRateLimit(e,t,s){try{var r,a,o;let i=await this.makeRequestWithRateLimit("".concat(e,"/ReasonCodes?category=NOT_READY"),{method:"GET",headers:{Authorization:"Basic ".concat(t),Accept:"application/xml"}},s,"reason-codes");if(!i.ok)return{success:!1,error:"Erro ao buscar c\xf3digos de motivo: ".concat(i.status)};let n=await i.text(),l=this.parseXmlToJson(n);if(l.ApiErrors)return{success:!1,error:(null===(o=l.ApiErrors.ApiError)||void 0===o?void 0:null===(a=o.ErrorMessage)||void 0===a?void 0:a.text)||"Erro ao buscar c\xf3digos"};let c=[];return(null===(r=l.ReasonCodes)||void 0===r?void 0:r.ReasonCode)&&(c=(Array.isArray(l.ReasonCodes.ReasonCode)?l.ReasonCodes.ReasonCode:[l.ReasonCodes.ReasonCode]).map(e=>({id:e.id||{text:""},label:e.label||{text:""},category:e.category||"NOT_READY"}))),{success:!0,data:c}}catch(e){if(e instanceof Error&&e.message.includes("Rate limit"))return{success:!1,error:e.message};return{success:!1,error:e instanceof Error?e.message:"Erro de conex\xe3o"}}}getServiceInfo(){return{baseUrl:this.baseUrl,fallbackUrl:this.fallbackUrl,allowedDomains:[...this.allowedDomains],timeout:this.requestTimeout}}constructor(){if(this.requestTimeout=1e4,this.baseUrl="https://sncfinesse1.totvs.com.br:8445/finesse/api",this.fallbackUrl="https://sncfinesse2.totvs.com.br:8445/finesse/api",this.allowedDomains="@jv01.local,@totvs.com.br".split(",").map(e=>e.trim()),!this.baseUrl||!this.fallbackUrl)throw Error("URLs do Finesse n\xe3o configuradas nas vari\xe1veis de ambiente")}}let u=new d;var m=s(8110),h=s.n(m);class g{encrypt(e){try{return h().AES.encrypt(e,this.secretKey).toString()}catch(e){throw console.error("Erro na criptografia:",e),Error("Falha na criptografia dos dados")}}decrypt(e){try{let t=h().AES.decrypt(e,this.secretKey).toString(h().enc.Utf8);if(!t)throw Error("Falha na descriptografia - dados corrompidos");return t}catch(e){throw console.error("Erro na descriptografia:",e),Error("Falha na descriptografia dos dados")}}generateHash(e){return h().SHA256(e+this.secretKey).toString()}validateHash(e,t){return this.generateHash(e)===t}encryptObject(e){try{let t=JSON.stringify(e);return this.encrypt(t)}catch(e){throw console.error("Erro na criptografia do objeto:",e),Error("Falha na criptografia do objeto")}}decryptObject(e){try{let t=this.decrypt(e);return JSON.parse(t)}catch(e){throw console.error("Erro na descriptografia do objeto:",e),Error("Falha na descriptografia do objeto")}}constructor(){if(this.secretKey="1H6HE+Ah1NgllfND7gHS8TUyJ+3uG0XyhR1Kzenef5c=",!this.secretKey)throw Error("Encryption key not found in environment variables")}}let x=new g;class f{async saveCredentials(e){try{let t=x.encryptObject(e),s=x.generateHash(JSON.stringify(e)),r={encryptedData:t,hash:s,timestamp:Date.now()};if(this.isExtension)return new Promise(e=>{chrome.storage.local.set({secureCredentials:r},()=>{e(!chrome.runtime.lastError)})});return localStorage.setItem("secureCredentials",JSON.stringify(r)),!0}catch(e){return console.error("Erro ao salvar credenciais:",e),!1}}async getCredentials(){try{let e=null;if(this.isExtension)e=await new Promise(e=>{chrome.storage.local.get(["secureCredentials"],t=>{if(chrome.runtime.lastError||!t.secureCredentials){e(null);return}e(t.secureCredentials)})});else{let t=localStorage.getItem("secureCredentials");t&&(e=JSON.parse(t))}if(!e)return null;if((Date.now()-e.timestamp)/6e4>this.securityConfig.sessionTimeout)return await this.removeCredentials(),null;let t=x.decryptObject(e.encryptedData);if(!x.validateHash(JSON.stringify(t),e.hash))return console.error("Dados corrompidos detectados"),await this.removeCredentials(),null;return t}catch(e){return console.error("Erro ao recuperar credenciais:",e),await this.removeCredentials(),null}}async removeCredentials(){try{if(this.isExtension)return new Promise(e=>{chrome.storage.local.remove(["secureCredentials"],()=>{e(!chrome.runtime.lastError)})});return localStorage.removeItem("secureCredentials"),!0}catch(e){return console.error("Erro ao remover credenciais:",e),!1}}async recordLoginAttempt(e,t){let s="loginAttempts_".concat(t),r=await this.getLoginAttempts(t);e?this.isExtension?chrome.storage.local.remove([s]):localStorage.removeItem(s):(r.count++,r.lastAttempt=Date.now(),this.isExtension?chrome.storage.local.set({[s]:r}):localStorage.setItem(s,JSON.stringify(r)))}async getLoginAttempts(e){let t="loginAttempts_".concat(e),s={count:0,lastAttempt:0};try{if(this.isExtension)return new Promise(e=>{chrome.storage.local.get([t],r=>{e(r[t]||s)})});{let e=localStorage.getItem(t);return e?JSON.parse(e):s}}catch(e){return s}}async isAccountLocked(e){let t=await this.getLoginAttempts(e);if(t.count<this.securityConfig.maxLoginAttempts)return!1;let s=(Date.now()-t.lastAttempt)/6e4<this.securityConfig.lockoutDuration;return s||await this.recordLoginAttempt(!0,e),s}async saveScheduleSettings(e){try{if(this.isExtension)return new Promise(t=>{chrome.storage.local.set({scheduleSettings:e},()=>{t(!chrome.runtime.lastError)})});return localStorage.setItem("scheduleSettings",JSON.stringify(e)),!0}catch(e){return console.error("Erro ao salvar configura\xe7\xf5es de hor\xe1rio:",e),!1}}async getScheduleSettings(){try{if(this.isExtension)return new Promise(e=>{chrome.storage.local.get(["scheduleSettings"],t=>{if(chrome.runtime.lastError||!t.scheduleSettings){e(null);return}e(t.scheduleSettings)})});{let e=localStorage.getItem("scheduleSettings");return e?JSON.parse(e):null}}catch(e){return console.error("Erro ao recuperar configura\xe7\xf5es de hor\xe1rio:",e),null}}async saveTimerSettings(e){let t=parseInt("1"),s=parseInt("120");if(e.standardTimer<t||e.standardTimer>s||e.pauseTimer<t||e.pauseTimer>s||e.pauseTimer<=e.standardTimer)return!1;try{if(this.isExtension)return new Promise(t=>{chrome.storage.local.set({timerSettings:e},()=>{t(!chrome.runtime.lastError)})});return localStorage.setItem("timerSettings",JSON.stringify(e)),!0}catch(e){return console.error("Erro ao salvar configura\xe7\xf5es de timer:",e),!1}}async getTimerSettings(){let e={standardTimer:parseInt("5"),pauseTimer:parseInt("30")};try{if(this.isExtension)return new Promise(t=>{chrome.storage.local.get(["timerSettings"],s=>{if(chrome.runtime.lastError||!s.timerSettings){t(e);return}t(s.timerSettings)})});{let t=localStorage.getItem("timerSettings");return t?JSON.parse(t):e}}catch(t){return console.error("Erro ao recuperar configura\xe7\xf5es de timer:",t),e}}async saveNotificationConfig(e){if(e.googleChatWebhook)try{if("chat.googleapis.com"!==new URL(e.googleChatWebhook).hostname)return!1}catch(e){return!1}try{if(this.isExtension)return new Promise(t=>{chrome.storage.local.set({notificationConfig:e},()=>{t(!chrome.runtime.lastError)})});return localStorage.setItem("notificationConfig",JSON.stringify(e)),!0}catch(e){return console.error("Erro ao salvar configura\xe7\xf5es de notifica\xe7\xe3o:",e),!1}}async getNotificationConfig(){let e={windowsNotification:!0,googleChatNotification:!1};try{if(this.isExtension)return new Promise(t=>{chrome.storage.local.get(["notificationConfig"],s=>{if(chrome.runtime.lastError||!s.notificationConfig){t(e);return}t(s.notificationConfig)})});{let t=localStorage.getItem("notificationConfig");return t?JSON.parse(t):e}}catch(t){return console.error("Erro ao recuperar configura\xe7\xf5es de notifica\xe7\xe3o:",t),e}}async saveAgentStatus(e){try{let t={status:e,timestamp:Date.now()};if(this.isExtension)return new Promise(e=>{chrome.storage.local.set({agentStatus:t},()=>{e(!chrome.runtime.lastError)})});return localStorage.setItem("agentStatus",JSON.stringify(t)),!0}catch(e){return console.error("Erro ao salvar status do agente:",e),!1}}async getLastAgentStatus(){try{if(this.isExtension)return new Promise(e=>{chrome.storage.local.get(["agentStatus"],t=>{if(chrome.runtime.lastError||!t.agentStatus){e(null);return}e({status:t.agentStatus.status,timestamp:new Date(t.agentStatus.timestamp)})})});{let e=localStorage.getItem("agentStatus");if(!e)return null;let t=JSON.parse(e);return{status:t.status,timestamp:new Date(t.timestamp)}}}catch(e){return console.error("Erro ao recuperar \xfaltimo status do agente:",e),null}}async clearAllData(){try{if(this.isExtension)return new Promise(e=>{chrome.storage.local.clear(()=>{e(!chrome.runtime.lastError)})});return localStorage.clear(),!0}catch(e){return console.error("Erro ao limpar dados:",e),!1}}getSecurityConfig(){return{...this.securityConfig}}constructor(){this.isExtension="undefined"!=typeof chrome&&chrome.storage,this.securityConfig={maxLoginAttempts:parseInt("10"),lockoutDuration:parseInt("15"),sessionTimeout:parseInt("60")}}}let p=new f;(r=a||(a={})).NOT_READY="playAudioNotReady",r.DEVICE_ERROR="playAudioDeviceError",r.TIME_EXCEEDED="playAudioIntervalTimeExceed";class b{async sendWindowsNotification(e){try{if(!("Notification"in window))return console.warn("Este navegador n\xe3o suporta notifica\xe7\xf5es desktop"),!1;if("granted"===Notification.permission)return this.createNotification(e),!0;if("denied"!==Notification.permission){let t=await Notification.requestPermission();if("granted"===t)return this.createNotification(e),!0}return!1}catch(e){return console.error("Erro ao enviar notifica\xe7\xe3o Windows:",e),!1}}createNotification(e){let t=new Notification("Notifica\xe7\xe3o Finesse",{body:e.message,tag:"finesse-notification",requireInteraction:!0});setTimeout(()=>{t.close()},5e3),t.onclick=()=>{window.focus(),this.focusFinesseTab(),t.close()}}focusFinesseTab(){"undefined"!=typeof chrome&&chrome.tabs&&chrome.tabs.query({url:["https://sncfinesse1.totvs.com.br:8445/","https://sncfinesse2.totvs.com.br:8445/"]},e=>{e.length>0&&chrome.tabs.update(e[0].id,{active:!0})})}async sendGoogleChatNotification(e,t){try{let s={text:this.formatGoogleChatMessage(t),cards:[{header:{title:"\uD83D\uDD14 Finesse Notifier",subtitle:"Agente: ".concat(t.agentId||"N/A")},sections:[{widgets:[{textParagraph:{text:"<b>Mensagem:</b> ".concat(t.message)}},{textParagraph:{text:"<b>Hor\xe1rio:</b> ".concat(t.timestamp.toLocaleString("pt-BR"))}},{buttons:[{textButton:{text:"Acessar Finesse",onClick:{openLink:{url:"https://sncfinesse1.totvs.com.br:8445/"}}}}]}]}]}]};return(await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok}catch(e){return console.error("Erro ao enviar notifica\xe7\xe3o Google Chat:",e),!1}}formatGoogleChatMessage(e){let t=this.getNotificationIcon(e.type);return"".concat(t," *Finesse Alert* - ").concat(e.message)}getNotificationIcon(e){switch(e){case a.NOT_READY:return"⚠️";case a.DEVICE_ERROR:return"\uD83D\uDD0C";case a.TIME_EXCEEDED:return"⏰";default:return"\uD83D\uDD14"}}async checkNotificationPermissions(){return{windows:"Notification"in window&&"granted"===Notification.permission,googleChat:!0,webhookConfigured:!!(await this.getStorageData(["googleChatWebhook"])).googleChatWebhook}}async getStorageData(e){return new Promise(t=>{if("undefined"!=typeof chrome&&chrome.storage)chrome.storage.local.get(e,t);else{let s={};e.forEach(e=>{let t=localStorage.getItem(e);if(t)try{s[e]=JSON.parse(t)}catch(r){s[e]=t}}),t(s)}})}async requestNotificationPermission(){return"Notification"in window&&("granted"===Notification.permission||"denied"!==Notification.permission&&"granted"===await Notification.requestPermission())}getMessage(e,t){let s=this.notificationMessages[e];return"function"==typeof s?s(t||0):s}constructor(){this.notificationMessages={[a.NOT_READY]:"Telefone Desconectado - Status N\xe3o Pronto",[a.DEVICE_ERROR]:"Telefone Desconectado - Verifique a VPN / Cisco Jabber / Finesse",[a.TIME_EXCEEDED]:e=>"Voc\xea est\xe1 h\xe1 mais de ".concat(e," minutos com o telefone em pausa")}}}let y=new b;var v=s(583),w=s(8672),N=s(4184),j=s(5296);class E{isWithinWorkingHours(e){if(!e||e.notifyOutsideHours)return!0;let t=new Date,s=t.getDay(),r=(0,v.WU)(t,"HH:mm"),a=e.workSchedules.find(e=>e.dayOfWeek===s&&e.enabled);if(!a)return!1;let o=(0,w.Qc)(a.startTime,"HH:mm",new Date),i=(0,w.Qc)(a.endTime,"HH:mm",new Date),n=(0,w.Qc)(r,"HH:mm",new Date);return(0,N.J)(o)&&(0,N.J)(i)&&(0,N.J)(n)?(0,j._)(n,{start:o,end:i}):(console.error("Hor\xe1rios inv\xe1lidos na configura\xe7\xe3o"),!0)}getDefaultScheduleSettings(){return{workSchedules:this.defaultSchedule,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,notifyOutsideHours:!1}}validateSchedule(e){return e.dayOfWeek<0||e.dayOfWeek>6?{valid:!1,error:"Dia da semana inv\xe1lido"}:this.isValidTime(e.startTime)&&this.isValidTime(e.endTime)?(0,w.Qc)(e.startTime,"HH:mm",new Date)>=(0,w.Qc)(e.endTime,"HH:mm",new Date)?{valid:!1,error:"Hor\xe1rio de in\xedcio deve ser menor que o hor\xe1rio de fim"}:{valid:!0}:{valid:!1,error:"Formato de hor\xe1rio inv\xe1lido (use HH:mm)"}}isValidTime(e){return/^([01]?[0-9]|2[0-3]):[0-5][0-9]$/.test(e)}getDayName(e){return["Domingo","Segunda","Ter\xe7a","Quarta","Quinta","Sexta","S\xe1bado"][e]||"Desconhecido"}shouldMonitor(e,t){return!!e&&this.isWithinWorkingHours(t)}getNextWorkingTime(e){let t=new Date,s=t.getDay();for(let r=0;r<7;r++){let a=(s+r)%7,o=e.workSchedules.find(e=>e.dayOfWeek===a&&e.enabled);if(o){let e=new Date(t);e.setDate(e.getDate()+r);let s=(0,w.Qc)(o.startTime,"HH:mm",e);if(0===r&&s<=t)continue;return s}}return null}constructor(){this.defaultSchedule=[{id:"1",dayOfWeek:1,startTime:"08:00",endTime:"18:00",enabled:!0},{id:"2",dayOfWeek:2,startTime:"08:00",endTime:"18:00",enabled:!0},{id:"3",dayOfWeek:3,startTime:"08:00",endTime:"18:00",enabled:!0},{id:"4",dayOfWeek:4,startTime:"08:00",endTime:"18:00",enabled:!0},{id:"5",dayOfWeek:5,startTime:"08:00",endTime:"18:00",enabled:!0},{id:"6",dayOfWeek:6,startTime:"08:00",endTime:"12:00",enabled:!1},{id:"7",dayOfWeek:0,startTime:"08:00",endTime:"12:00",enabled:!1}]}}let C=new E;class T{async isFinesseOpen(){if("undefined"==typeof chrome||!chrome.tabs)return!0;try{return new Promise(e=>{let t=this.finesseUrls.map(e=>"".concat(e,"/*"));chrome.tabs.query({url:t},t=>{if(chrome.runtime.lastError){console.error("Erro ao verificar abas do Finesse:",chrome.runtime.lastError),e(!1);return}let s=t.find(e=>e.active||e.audible);e(void 0!==s&&t.length>0)})})}catch(e){return console.error("Erro na detec\xe7\xe3o do Finesse:",e),!1}}async focusFinesseTab(){if("undefined"==typeof chrome||!chrome.tabs){let e=this.finesseUrls[0];return!!e&&(window.open(e,"_blank"),!0)}try{return new Promise(e=>{let t=this.finesseUrls.map(e=>"".concat(e,"/*"));chrome.tabs.query({url:t},t=>{if(chrome.runtime.lastError||0===t.length){chrome.tabs.create({url:this.finesseUrls[0]}),e(!0);return}let s=t[0];chrome.tabs.update(s.id,{active:!0},()=>{if(chrome.runtime.lastError){e(!1);return}chrome.windows.update(s.windowId,{focused:!0}),e(!0)})})})}catch(e){return console.error("Erro ao focar aba do Finesse:",e),!1}}startTabMonitoring(e){"undefined"!=typeof chrome&&chrome.tabs&&(chrome.tabs.onRemoved.addListener(async(t,s)=>{e(await this.isFinesseOpen())}),chrome.tabs.onCreated.addListener(async t=>{t.url&&this.isFinesseUrl(t.url)&&e(!0)}),chrome.tabs.onUpdated.addListener(async(t,s,r)=>{s.url&&(this.isFinesseUrl(s.url)||this.wasFinesseUrl(s.url))&&e(await this.isFinesseOpen())}))}isFinesseUrl(e){return this.finesseUrls.some(t=>e.startsWith(t))}wasFinesseUrl(e){return this.isFinesseUrl(e)}getFinesseUrls(){return[...this.finesseUrls]}constructor(){let e="https://sncfinesse1.totvs.com.br:8445/finesse/api".replace("/finesse/api","")||"",t="https://sncfinesse2.totvs.com.br:8445/finesse/api".replace("/finesse/api","")||"";this.finesseUrls=[e,t].filter(e=>e)}}let S=new T,k=()=>{let[e,t]=(0,i.useState)(null),[s,r]=(0,i.useState)(!1),[o,n]=(0,i.useState)(!0),[l,c]=(0,i.useState)(null),[d,m]=(0,i.useState)(null),[h,g]=(0,i.useState)(!0),[x,f]=(0,i.useState)(!1),[b,v]=(0,i.useState)(10),[w,N]=(0,i.useState)({standardTimer:parseInt("5"),pauseTimer:parseInt("30")}),[j,E]=(0,i.useState)({windowsNotification:!0,googleChatNotification:!1}),[T,k]=(0,i.useState)(C.getDefaultScheduleSettings()),A=(0,i.useRef)(null),D=(0,i.useRef)(null),R=(0,i.useRef)(null),O=(0,i.useRef)(null),I=(0,i.useCallback)(async function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=e||d;if(o){s&&n(!0);try{let e=C.shouldMonitor(h,T);if(!e){r(!1),c("Monitoramento pausado (fora do hor\xe1rio ou Finesse fechado)"),s&&n(!1);return}let l=await u.connectApi(o);if(l.success&&l.data){let e=l.data;t(e),r(!0),c(null),await p.saveAgentStatus(e);let s=e.reasonCodeId?e.reasonCodeId.text:null,a=e.state?e.state.text:null,o="".concat(a,"_").concat(s);O.current!==o&&(console.log("Status mudou de ".concat(O.current," para ").concat(o)),O.current=o,await L(e))}else{var i;r(!1),(null===(i=l.error)||void 0===i?void 0:i.includes("Rate limit"))?(c("".concat(l.error," - Aguardando pr\xf3xima verifica\xe7\xe3o autom\xe1tica.")),console.log("Rate limit atingido - aguardando reset autom\xe1tico")):(c(l.error||"Erro na conex\xe3o com Finesse"),e&&C.isWithinWorkingHours(T)&&await W(a.DEVICE_ERROR))}}catch(e){r(!1),c("Erro na verifica\xe7\xe3o do status"),console.error("Erro no checkAgentStatus:",e)}s&&n(!1)}},[d,h,T]),L=async e=>{let t=e.reasonCodeId?parseInt(e.reasonCodeId.text):null,s=e.state?e.state.text:null;if(console.log("Analisando status para notifica\xe7\xf5es: State=".concat(s,", ReasonCode=").concat(t)),!C.isWithinWorkingHours(T)){console.log("Fora do hor\xe1rio de trabalho - notifica\xe7\xf5es suspensas");return}if(U(),-1===t)console.log("Status NOT_READY detectado - enviando notifica\xe7\xe3o"),await W(a.NOT_READY),await F();else if(t&&t>0){console.log("Pausa detectada com c\xf3digo ".concat(t," - iniciando timer de pausa"));let e=6e4*w.pauseTimer;D.current=setTimeout(async()=>{console.log("Timer de pausa expirou ap\xf3s ".concat(w.pauseTimer," minutos")),await W(a.TIME_EXCEEDED,w.pauseTimer),await F()},e)}else"NOT_READY"===s&&(console.log("Status NOT_READY gen\xe9rico detectado"),await W(a.NOT_READY),await F());P()},W=async(e,t)=>{let s=y.getMessage(e,t),r={type:e,message:s,timestamp:new Date,agentId:null==d?void 0:d.agentId};console.log("Enviando notifica\xe7\xe3o: ".concat(s));try{j.windowsNotification&&await y.sendWindowsNotification(r),j.googleChatNotification&&j.googleChatWebhook&&await y.sendGoogleChatNotification(j.googleChatWebhook,r)}catch(e){console.error("Erro ao enviar notifica\xe7\xe3o:",e)}},F=async()=>{try{await S.focusFinesseTab()}catch(e){console.error("Erro ao focar aba do Finesse:",e)}},P=(0,i.useCallback)(()=>{R.current&&clearInterval(R.current),R.current=setInterval(()=>{I()},6e4),console.log("Monitoramento em tempo real iniciado 60s)")},[I]),M=(0,i.useCallback)(()=>{U(),I(),A.current=setInterval(()=>{I()},6e4*w.standardTimer),P(),console.log("Monitoramento iniciado - Timer principal: ".concat(w.standardTimer,"min"))},[I,w.standardTimer,P]),U=(0,i.useCallback)(()=>{A.current&&(clearInterval(A.current),A.current=null),D.current&&(clearTimeout(D.current),D.current=null),R.current&&(clearInterval(R.current),R.current=null),console.log("Monitoramento parado")},[]),_=async e=>{n(!0),c(null);try{if(await p.isAccountLocked(e.username)){let e=p.getSecurityConfig();return f(!0),c("Conta bloqueada por ".concat(e.lockoutDuration," minutos devido a muitas tentativas incorretas")),!1}let s=await u.connectApi(e);if(s.success&&s.data&&s.data.firstName){await Promise.all([p.saveCredentials(e),p.recordLoginAttempt(!0,e.username)]),m(e),t(s.data),r(!0),f(!1),v(10);let a=s.data.reasonCodeId?s.data.reasonCodeId.text:null,o=s.data.state?s.data.state.text:null;return O.current="".concat(o,"_").concat(a),M(),!0}{await p.recordLoginAttempt(!1,e.username);let t=await p.getLoginAttempts(e.username),r=p.getSecurityConfig(),a=Math.max(0,r.maxLoginAttempts-t.count);return v(a),c(s.error||"Credenciais inv\xe1lidas"),0===a&&f(!0),!1}}catch(e){return c("Erro na tentativa de login"),!1}finally{n(!1)}},q=async()=>{U(),await p.removeCredentials(),m(null),t(null),r(!1),c(null),f(!1),v(10),O.current=null},H=async(e,t)=>{if(!d)return!1;n(!0);try{let s=await u.changeAgentState(d,e,t);if(s.success)return console.log("Estado alterado para ".concat(e," ").concat(t?"com c\xf3digo ".concat(t):"")),setTimeout(async()=>{await I(d)},1e3),!0;return c(s.error||"Erro ao alterar status"),!1}catch(e){return c("Erro na altera\xe7\xe3o do status"),!1}finally{n(!1)}},Y=async()=>{if(!d)return[];try{let e=await u.getReasonCodes(d);return e.success&&e.data||[]}catch(e){return console.error("Erro ao buscar c\xf3digos de motivo:",e),[]}},J=async e=>{console.log("Atualizando configura\xe7\xf5es de timer: ".concat(e.standardTimer,"min / ").concat(e.pauseTimer,"min"));let t=await p.saveTimerSettings(e);return t&&(N(e),s&&d&&(U(),setTimeout(M,1e3))),t},z=async e=>{let t=await p.saveNotificationConfig(e);return t&&E(e),t},X=async e=>{let t=await p.saveScheduleSettings(e);return t&&(k(e),console.log("Configura\xe7\xf5es de hor\xe1rio atualizadas:",e)),t},G=async()=>{await W(a.NOT_READY)},V=async()=>{d&&await I(d,!0)};return(0,i.useEffect)(()=>{let e=async()=>{g(await S.isFinesseOpen())};e(),S.startTabMonitoring(e=>{g(e)});let t=setInterval(e,6e4);return()=>{clearInterval(t)}},[]),(0,i.useEffect)(()=>((async()=>{n(!0);try{let[e,t,s,r]=await Promise.all([p.getCredentials(),p.getTimerSettings(),p.getNotificationConfig(),p.getScheduleSettings()]);N(t),E(s),r&&k(r),console.log("Configura\xe7\xf5es carregadas:",{timer:t,schedule:r,notifications:s}),e&&(await p.isAccountLocked(e.username)?(f(!0),await p.removeCredentials(),c("Sess\xe3o expirada por motivos de seguran\xe7a")):(m(e),await I(e),M()))}catch(e){c("Erro na inicializa\xe7\xe3o da aplica\xe7\xe3o"),console.error("Erro na inicializa\xe7\xe3o:",e)}finally{n(!1)}})(),()=>{U()}),[]),(0,i.useEffect)(()=>{s&&d&&(console.log("Reiniciando monitoramento devido a mudan\xe7a de configura\xe7\xf5es"),U(),setTimeout(M,1e3))},[w.standardTimer,T,h]),{agentStatus:e,isConnected:s,isLoading:o,error:l,credentials:d,timerSettings:w,notificationConfig:j,scheduleSettings:T,isFinesseOpen:h,isAccountLocked:x,remainingAttempts:b,login:_,logout:q,changeAgentState:H,updateTimerSettings:J,updateNotificationConfig:z,updateScheduleSettings:X,testNotification:G,refreshStatus:V,getReasonCodes:Y}},A=e=>{let{onLogin:t,isLoading:s,error:r,isAccountLocked:a,remainingAttempts:n}=e,[l,c]=(0,i.useState)({username:"",password:"",agentId:""}),[d,u]=(0,i.useState)(!1),m=async e=>{e.preventDefault(),!a&&l.username&&l.password&&l.agentId&&await t(l)},h=e=>{let{name:t,value:s}=e.target,r=s;"agentId"===t&&(r=s.replace(/[^0-9.]/g,"")).length>11&&(r=r.substring(0,11)),"username"===t&&(r=s.toLowerCase().trim()),c(e=>({...e,[t]:r}))};return(0,o.jsx)("div",{className:"w-full max-w-md mx-auto",children:(0,o.jsxs)("div",{className:"bg-white shadow-xl rounded-lg px-8 pt-6 pb-8 mb-4",children:[(0,o.jsxs)("div",{className:"mb-6 text-center",children:[(0,o.jsx)("h2",{className:"text-3xl font-bold text-gray-900",children:"Finesse Notifier"}),(0,o.jsx)("p",{className:"text-gray-600 mt-2",children:"Entre com suas credenciais"}),a&&(0,o.jsxs)("div",{className:"mt-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:[(0,o.jsx)("p",{className:"text-sm font-medium",children:"Conta temporariamente bloqueada"}),(0,o.jsx)("p",{className:"text-xs mt-1",children:"Tente novamente em alguns minutos"})]})]}),(0,o.jsxs)("form",{onSubmit:m,className:"space-y-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"username",children:"Email corporativo:"}),(0,o.jsx)("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline border-gray-300",id:"username",name:"username",type:"email",placeholder:"nome.sobrenome@jv01.local",value:l.username,onChange:h,disabled:s||a,autoComplete:"username",required:!0})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"agentId",children:"ID do Agente:"}),(0,o.jsx)("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline border-gray-300",id:"agentId",name:"agentId",type:"text",placeholder:"80.590.269",value:l.agentId,onChange:h,disabled:s||a,maxLength:11,required:!0}),(0,o.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Digite apenas n\xfameros ou no formato XX.XXX.XXX"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"password",children:"Senha:"}),(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline border-gray-300",id:"password",name:"password",type:d?"text":"password",placeholder:"••••••••",value:l.password,onChange:h,disabled:s||a,autoComplete:"current-password",required:!0}),(0,o.jsx)("button",{type:"button",onClick:()=>u(!d),className:"absolute inset-y-0 right-0 pr-3 flex items-center",disabled:s||a,tabIndex:-1,children:d?(0,o.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"})}):(0,o.jsxs)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),r&&(0,o.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("svg",{className:"h-4 w-4 text-red-500 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,o.jsxs)("div",{className:"text-sm",children:[(0,o.jsx)("p",{className:"font-medium",children:"Erro no login:"}),(0,o.jsx)("p",{children:r})]})]})}),!a&&n<10&&n>0&&(0,o.jsx)("div",{className:"bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded mb-4",children:(0,o.jsxs)("p",{className:"text-sm",children:["Tentativas restantes: ",(0,o.jsx)("strong",{children:n})]})}),(0,o.jsx)("div",{className:"flex items-center justify-between",children:(0,o.jsx)("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline w-full disabled:opacity-50 disabled:cursor-not-allowed transition-colors",type:"submit",disabled:s||a,children:s?(0,o.jsxs)("div",{className:"flex items-center justify-center",children:[(0,o.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Conectando..."]}):"Entrar"})})]}),(0,o.jsxs)("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-md p-4",children:[(0,o.jsx)("h5",{className:"text-sm font-medium text-blue-900 mb-2",children:"Dicas importantes:"}),(0,o.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1",children:[(0,o.jsx)("li",{children:"• Use suas credenciais normais do Finesse"}),(0,o.jsx)("li",{children:"• Agent ID deve ser com ou pontos (ex: 80.590.269)"}),(0,o.jsx)("li",{children:"• Verifique se est\xe1 conectado na VPN"}),(0,o.jsx)("li",{children:"• Certifique-se que o Jabber est\xe1 funcionando"})]})]})]})})},D=e=>{var t,s,r,a,i;let{status:n,isConnected:l,onRefresh:c,isLoading:d=!1}=e;return(0,o.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-6 mb-6",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("div",{className:"w-4 h-4 rounded-full mr-3 ".concat((e=>{switch(e){case"READY":return"bg-green-500";case"NOT_READY":return"bg-red-500";case"WORK_READY":return"bg-yellow-500";default:return"bg-gray-500"}})(null==n?void 0:null===(t=n.state)||void 0===t?void 0:t.text))}),(0,o.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Status do Agente"})]}),(0,o.jsx)("button",{onClick:c,disabled:d,className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-3 rounded text-sm disabled:opacity-50",children:d?"...":"Atualizar"})]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"text-sm text-gray-600",children:"Agente conectado:"}),(0,o.jsx)("p",{className:"font-bold text-gray-900",children:n&&n.firstName&&n.lastName?"".concat(n.firstName.text," ").concat(n.lastName.text):"Desconectado"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"text-sm text-gray-600",children:"Status atual:"}),(0,o.jsx)("p",{className:"font-bold text-gray-900",children:l?n?(null===(s=n.state)||void 0===s?void 0:s.text)==="READY"?"Pronto":(null===(r=n.reasonCodeId)||void 0===r?void 0:r.text)==="-1"?"N\xe3o Est\xe1 Pronto":(null===(a=n.label)||void 0===a?void 0:a.text)?n.label.text:(null===(i=n.state)||void 0===i?void 0:i.text)||"Desconhecido":"Carregando...":"Desconectado"})]})]}),!l&&(0,o.jsx)("div",{className:"mt-4 bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded",children:"Verifique a conex\xe3o VPN, Cisco Jabber e Finesse"})]})},R=e=>{let{currentState:t,onStateChange:s,getReasonCodes:r}=e,[a,n]=(0,i.useState)(!1),[l,c]=(0,i.useState)([]),[d,u]=(0,i.useState)(""),[m,h]=(0,i.useState)(!1);(0,i.useEffect)(()=>{g()},[]);let g=async()=>{h(!0);try{let e=await r();c(e)}catch(e){console.error("Erro ao carregar c\xf3digos de motivo:",e)}finally{h(!1)}},x=async e=>{n(!0);try{await s(e,"NOT_READY"===e?d:void 0)&&u("")}finally{n(!1)}};return(0,o.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-6 mb-6",children:[(0,o.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Alterar Status do Agente"}),(0,o.jsx)("div",{className:"mb-6 p-4 rounded-lg border-2 border-gray-200",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Status atual:"}),(0,o.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat((e=>{switch(e){case"READY":return"text-green-600 bg-green-100";case"NOT_READY":return"text-red-600 bg-red-100";case"WORK_READY":return"text-blue-600 bg-blue-100";default:return"text-gray-600 bg-gray-100"}})(t)),children:(e=>{switch(e){case"READY":return"Pronto";case"NOT_READY":return"N\xe3o Pronto";case"WORK_READY":return"Trabalhando";default:return"Desconhecido"}})(t)})]})}),(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("button",{onClick:()=>x("READY"),disabled:a||"READY"===t,className:"w-full bg-green-500 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:a?"Alterando...":"Definir como Pronto"}),(0,o.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Define o status como dispon\xedvel para receber chamadas"})]}),(0,o.jsxs)("div",{className:"border-t pt-4",children:[(0,o.jsx)("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"Pausas e Motivos"}),m?(0,o.jsxs)("div",{className:"animate-pulse",children:[(0,o.jsx)("div",{className:"h-10 bg-gray-200 rounded mb-2"}),(0,o.jsx)("div",{className:"h-10 bg-gray-200 rounded"})]}):(0,o.jsxs)("div",{className:"space-y-3",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{htmlFor:"reasonCode",className:"block text-sm font-medium text-gray-700 mb-1",children:"Selecione o motivo da pausa:"}),(0,o.jsxs)("select",{id:"reasonCode",value:d,onChange:e=>u(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,o.jsx)("option",{value:"",children:"-- Selecione um motivo --"}),l.map((e,t)=>{var s,r,a,i;return(0,o.jsx)("option",{value:(null===(s=e.id)||void 0===s?void 0:s.text)||"",children:(null===(r=e.label)||void 0===r?void 0:r.text)||"C\xf3digo ".concat(null===(a=e.id)||void 0===a?void 0:a.text)},"".concat((null===(i=e.id)||void 0===i?void 0:i.text)||t))})]}),0===l.length&&!m&&(0,o.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Nenhum c\xf3digo de motivo dispon\xedvel"})]}),(0,o.jsx)("button",{onClick:()=>x("NOT_READY"),disabled:a||"NOT_READY"===t||!d,className:"w-full bg-red-500 hover:bg-red-700 text-white font-bold py-3 px-4 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:a?"Alterando...":"Definir como N\xe3o Pronto"}),!d&&(0,o.jsx)("p",{className:"text-xs text-gray-500",children:"Selecione um motivo para poder pausar o atendimento"})]})]}),l.length>0&&(0,o.jsxs)("div",{className:"border-t pt-4",children:[(0,o.jsx)("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Pausas r\xe1pidas:"}),(0,o.jsx)("div",{className:"grid grid-cols-2 gap-2",children:l.slice(0,4).map((e,s)=>{var r,i,n;let l=(null===(r=e.label)||void 0===r?void 0:r.text)||"C\xf3digo ".concat(null===(i=e.id)||void 0===i?void 0:i.text),c=l.toLowerCase().includes("almo\xe7o")||l.toLowerCase().includes("almoco"),d=l.toLowerCase().includes("banheiro")||l.toLowerCase().includes("wc"),m=l.toLowerCase().includes("pausa");return c||d||m?(0,o.jsx)("button",{onClick:()=>{var t;u((null===(t=e.id)||void 0===t?void 0:t.text)||""),x("NOT_READY")},disabled:a||"NOT_READY"===t,className:"text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 px-3 rounded disabled:opacity-50 transition-colors",children:l.length>15?"".concat(l.substring(0,15),"..."):l},"quick-".concat((null===(n=e.id)||void 0===n?void 0:n.text)||s)):null})})]})]}),(0,o.jsxs)("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-md p-4",children:[(0,o.jsx)("h6",{className:"text-sm font-medium text-blue-900 mb-2",children:"Informa\xe7\xf5es importantes:"}),(0,o.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1",children:[(0,o.jsx)("li",{children:'• Status "Pronto": Dispon\xedvel para receber chamadas'}),(0,o.jsx)("li",{children:'• Status "N\xe3o Pronto": Em pausa, n\xe3o receber\xe1 chamadas'}),(0,o.jsx)("li",{children:"• Sempre selecione o motivo correto para suas pausas"}),(0,o.jsx)("li",{children:"• O sistema monitora o tempo de pausa automaticamente"})]})]})]})},O=e=>{let{settings:t,onUpdate:s}=e,[r,a]=(0,i.useState)(t),[n,l]=(0,i.useState)(!1);(0,i.useEffect)(()=>{a(t)},[t]);let c=async(e,t)=>{let o=r[e]+t;if(o<1||o>120||"pauseTimer"===e&&o<=r.standardTimer||"standardTimer"===e&&o>=r.pauseTimer)return;let i={...r,[e]:o};a(i),l(!0),await s(i),l(!1)},d=async(e,t)=>{let o=parseInt(t);if(isNaN(o)||o<1||o>120)return;let i={...r,[e]:o};("pauseTimer"!==e||!(o<=r.standardTimer))&&("standardTimer"===e&&o>=r.pauseTimer||(a(i),l(!0),await s(i),l(!1)))};return(0,o.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-6 mb-6",children:[(0,o.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Configura\xe7\xf5es de Timer"}),(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Timer Principal (minutos)",(0,o.jsx)("span",{className:"text-xs text-gray-500 block",children:"Tempo para verifica\xe7\xe3o de falhas de conex\xe3o"})]}),(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,o.jsx)("button",{onClick:()=>c("standardTimer",-1),disabled:n||r.standardTimer<=1,className:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-1 px-2 rounded disabled:opacity-50",children:"-"}),(0,o.jsx)("input",{type:"number",min:"1",max:"119",value:r.standardTimer,onChange:e=>d("standardTimer",e.target.value),className:"w-20 px-3 py-1 text-center border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,o.jsx)("button",{onClick:()=>c("standardTimer",1),disabled:n||r.standardTimer>=119,className:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-1 px-2 rounded disabled:opacity-50",children:"+"})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Timer de Pausa (minutos)",(0,o.jsx)("span",{className:"text-xs text-gray-500 block",children:"Tempo para notifica\xe7\xe3o de pausas prolongadas"})]}),(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,o.jsx)("button",{onClick:()=>c("pauseTimer",-1),disabled:n||r.pauseTimer<=r.standardTimer+1,className:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-1 px-2 rounded disabled:opacity-50",children:"-"}),(0,o.jsx)("input",{type:"number",min:r.standardTimer+1,max:"120",value:r.pauseTimer,onChange:e=>d("pauseTimer",e.target.value),className:"w-20 px-3 py-1 text-center border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,o.jsx)("button",{onClick:()=>c("pauseTimer",1),disabled:n||r.pauseTimer>=120,className:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-1 px-2 rounded disabled:opacity-50",children:"+"})]})]}),r.pauseTimer<=r.standardTimer&&(0,o.jsx)("div",{className:"bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded",children:"O tempo de pausa deve ser maior que o timer principal"})]})]})},I=e=>{let{config:t,onUpdate:s,onTest:r}=e,[a,n]=(0,i.useState)(t),[l,c]=(0,i.useState)(!1),[d,u]=(0,i.useState)(!1),[m,h]=(0,i.useState)("");(0,i.useEffect)(()=>{n(t)},[t]);let g=async e=>{let t={...a,[e]:!a[e]};n(t),c(!0),await s(t),c(!1)},x=async e=>{if(h(""),e&&!f(e)){h("URL do webhook inv\xe1lida. Deve come\xe7ar com https://chat.googleapis.com");return}let t={...a,googleChatWebhook:e};n(t),c(!0),await s(t),c(!1)},f=e=>{try{let t=new URL(e);return"chat.googleapis.com"===t.hostname&&"https:"===t.protocol}catch(e){return!1}},p=async()=>{u(!0);try{await r()}finally{u(!1)}};return(0,o.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-6 mb-6",children:[(0,o.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Configura\xe7\xf5es de Notifica\xe7\xe3o"}),(0,o.jsxs)("div",{className:"space-y-6",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h4",{className:"text-md font-medium text-gray-900",children:"Notifica\xe7\xf5es do Windows"}),(0,o.jsx)("p",{className:"text-sm text-gray-600",children:"Exibir notifica\xe7\xf5es na \xe1rea de trabalho"})]}),(0,o.jsx)("button",{onClick:()=>g("windowsNotification"),disabled:l,className:"relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ".concat(a.windowsNotification?"bg-blue-600":"bg-gray-200"," ").concat(l?"opacity-50":""),children:(0,o.jsx)("span",{className:"pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ".concat(a.windowsNotification?"translate-x-5":"translate-x-0")})})]}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h4",{className:"text-md font-medium text-gray-900",children:"Google Chat"}),(0,o.jsx)("p",{className:"text-sm text-gray-600",children:"Enviar notifica\xe7\xf5es para o Google Chat"})]}),(0,o.jsx)("button",{onClick:()=>g("googleChatNotification"),disabled:l,className:"relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ".concat(a.googleChatNotification?"bg-blue-600":"bg-gray-200"," ").concat(l?"opacity-50":""),children:(0,o.jsx)("span",{className:"pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ".concat(a.googleChatNotification?"translate-x-5":"translate-x-0")})})]}),a.googleChatNotification&&(0,o.jsxs)("div",{className:"space-y-2",children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"URL do Webhook do Google Chat:"}),(0,o.jsx)("input",{type:"url",placeholder:"https://chat.googleapis.com/v1/spaces/...",value:a.googleChatWebhook||"",onChange:e=>x(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),m&&(0,o.jsx)("p",{className:"text-sm text-red-600",children:m}),(0,o.jsx)("p",{className:"text-xs text-gray-500",children:"Para obter o webhook, v\xe1 em Configura\xe7\xf5es do espa\xe7o → Aplicativos e integra\xe7\xf5es → Webhooks"})]})]}),(0,o.jsx)("div",{className:"pt-4 border-t border-gray-200",children:(0,o.jsx)("button",{onClick:p,disabled:d,className:"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline disabled:opacity-50",children:d?"Testando...":"Testar Notifica\xe7\xe3o"})}),(0,o.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:[(0,o.jsx)("h5",{className:"text-sm font-medium text-blue-900 mb-2",children:"Informa\xe7\xf5es importantes:"}),(0,o.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1",children:[(0,o.jsx)("li",{children:"• As notifica\xe7\xf5es do Windows requerem permiss\xe3o do navegador"}),(0,o.jsx)("li",{children:"• O Google Chat requer configura\xe7\xe3o de webhook no espa\xe7o desejado"}),(0,o.jsx)("li",{children:"• Se as notifica\xe7\xf5es do Windows estiverem desabilitadas, o Google Chat ser\xe1 usado como alternativa"})]})]})]})]})},L=e=>{let{settings:t,onUpdate:s}=e,[r,a]=(0,i.useState)(t),[n,l]=(0,i.useState)(!1),[c,d]=(0,i.useState)(null);(0,i.useEffect)(()=>{a(t)},[t]);let u=async e=>{let t=r.workSchedules.map((t,s)=>s===e?{...t,enabled:!t.enabled}:t),o={...r,workSchedules:t};a(o),l(!0),await s(o),l(!1)},m=async(e,t,o)=>{let i=r.workSchedules.map((s,r)=>{if(r===e){let e={...s,[t]:o};return C.validateSchedule(e).valid?e:s}return s}),n={...r,workSchedules:i};a(n),l(!0),await s(n),l(!1)},h=async e=>{let t={...r,notifyOutsideHours:e};a(t),l(!0),await s(t),l(!1)};return(0,o.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-6 mb-6",children:[(0,o.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Configura\xe7\xe3o de Hor\xe1rios"}),(0,o.jsx)("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg",children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("div",{className:"w-3 h-3 rounded-full mr-3 ".concat(C.isWithinWorkingHours(r)||r.notifyOutsideHours?"bg-green-500":"bg-yellow-500")}),(0,o.jsx)("span",{className:"text-sm font-medium text-blue-900",children:(()=>{let e=C.isWithinWorkingHours(r),t=new Date,s=t.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),a=C.getDayName(t.getDay());return r.notifyOutsideHours?"Monitoramento ativo 24/7 (".concat(a,", ").concat(s,")"):e?"Monitoramento ativo (".concat(a,", ").concat(s,")"):"Fora do hor\xe1rio de trabalho (".concat(a,", ").concat(s,")")})()})]})}),(0,o.jsxs)("div",{className:"flex items-center justify-between mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h4",{className:"text-md font-medium text-gray-900",children:"Monitoramento 24/7"}),(0,o.jsx)("p",{className:"text-sm text-gray-600",children:"Receber notifica\xe7\xf5es fora do hor\xe1rio de trabalho"})]}),(0,o.jsx)("button",{onClick:()=>h(!r.notifyOutsideHours),disabled:n,className:"relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ".concat(r.notifyOutsideHours?"bg-blue-600":"bg-gray-200"," ").concat(n?"opacity-50":""),children:(0,o.jsx)("span",{className:"pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ".concat(r.notifyOutsideHours?"translate-x-5":"translate-x-0")})})]}),!r.notifyOutsideHours&&(0,o.jsxs)("div",{className:"space-y-2",children:[(0,o.jsx)("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"Hor\xe1rios de Trabalho"}),r.workSchedules.map((e,t)=>{let s=C.getDayName(e.dayOfWeek),r=c===t;return(0,o.jsxs)("div",{className:"border border-gray-200 rounded-lg",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between p-4",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,o.jsx)("button",{onClick:()=>u(t),disabled:n,className:"relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ".concat(e.enabled?"bg-green-600":"bg-gray-200"," ").concat(n?"opacity-50":""),children:(0,o.jsx)("span",{className:"pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ".concat(e.enabled?"translate-x-5":"translate-x-0")})}),(0,o.jsxs)("div",{children:[(0,o.jsx)("span",{className:"font-medium text-gray-900",children:s}),e.enabled&&(0,o.jsxs)("span",{className:"ml-2 text-sm text-gray-600",children:[e.startTime," \xe0s ",e.endTime]})]})]}),e.enabled&&(0,o.jsx)("button",{onClick:()=>d(r?null:t),className:"text-blue-600 hover:text-blue-800",children:r?"Fechar":"Editar"})]}),r&&e.enabled&&(0,o.jsx)("div",{className:"px-4 pb-4 border-t border-gray-100",children:(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"In\xedcio"}),(0,o.jsx)("input",{type:"time",value:e.startTime,onChange:e=>m(t,"startTime",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fim"}),(0,o.jsx)("input",{type:"time",value:e.endTime,onChange:e=>m(t,"endTime",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})})]},e.id)})]}),(0,o.jsxs)("div",{className:"mt-6 bg-yellow-50 border border-yellow-200 rounded-md p-4",children:[(0,o.jsx)("h5",{className:"text-sm font-medium text-yellow-900 mb-2",children:"Informa\xe7\xf5es sobre hor\xe1rios:"}),(0,o.jsxs)("ul",{className:"text-sm text-yellow-700 space-y-1",children:[(0,o.jsx)("li",{children:"• As notifica\xe7\xf5es s\xf3 ser\xe3o enviadas durante os hor\xe1rios configurados"}),(0,o.jsx)("li",{children:"• Se o Finesse estiver fechado, as notifica\xe7\xf5es ser\xe3o suspensas"}),(0,o.jsx)("li",{children:"• O monitoramento 24/7 ignora os hor\xe1rios de trabalho"}),(0,o.jsx)("li",{children:"• Os hor\xe1rios s\xe3o baseados no fuso hor\xe1rio local do sistema"})]})]})]})},W=e=>{let{agentName:t,onLogout:s,onOpenDocs:r,onOpenStore:a,onOpenFeedback:n}=e,[l,c]=(0,i.useState)(!1);return(0,o.jsx)("header",{className:"bg-blue-600 text-white shadow-lg",children:(0,o.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,o.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("div",{className:"flex-shrink-0",children:(0,o.jsx)("h1",{className:"text-xl font-bold",children:"Finesse Notifier"})}),t&&(0,o.jsxs)("div",{className:"ml-4 text-sm",children:["Ol\xe1, ",t]})]}),(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("button",{onClick:()=>c(!l),className:"bg-blue-500 hover:bg-blue-700 text-white p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-blue-600 focus:ring-white",children:(0,o.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),l&&(0,o.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50",children:[(0,o.jsx)("button",{onClick:r,className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left",children:"Documenta\xe7\xe3o"}),(0,o.jsx)("button",{onClick:a,className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left",children:"Chrome Web Store"}),(0,o.jsx)("button",{onClick:n,className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left",children:"Enviar Feedback"}),(0,o.jsx)("div",{className:"border-t border-gray-100"}),(0,o.jsx)("button",{onClick:s,className:"block px-4 py-2 text-sm text-red-600 hover:bg-gray-100 w-full text-left",children:"Sair"})]})]})]})})})};function F(){var e;let{agentStatus:t,isConnected:s,isLoading:r,error:a,credentials:i,timerSettings:n,notificationConfig:l,scheduleSettings:c,isFinesseOpen:d,isAccountLocked:u,remainingAttempts:m,login:h,logout:g,changeAgentState:x,updateTimerSettings:f,updateNotificationConfig:p,updateScheduleSettings:b,testNotification:y,refreshStatus:v,getReasonCodes:w}=k(),N={openDocs:()=>window.open("https://tdn.totvs.com/pages/viewpage.action?pageId=961629221","_blank"),openStore:()=>window.open("https://chromewebstore.google.com/detail/finesse-notifier/cglkkcedledghdpkbopambajgmjmkkab","_blank"),openFeedback:()=>window.open("https://docs.google.com/forms/d/e/1FAIpQLSeeMiF6LywX6OfRddaWB1igSbn0TylLtRUy28AFWNP4KpC4iA/viewform?usp=dialog","_blank")};return r&&!i?(0,o.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,o.jsx)("div",{className:"bg-white p-8 rounded-lg shadow-lg",children:(0,o.jsxs)("div",{className:"flex items-center justify-center",children:[(0,o.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),(0,o.jsx)("span",{className:"ml-4 text-lg text-gray-600",children:"Carregando..."})]})})}):i?(0,o.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,o.jsx)(W,{agentName:(()=>{if(t&&t.firstName&&t.lastName)return"".concat(t.firstName.text," ").concat(t.lastName.text)})(),onLogout:g,onOpenDocs:N.openDocs,onOpenStore:N.openStore,onOpenFeedback:N.openFeedback}),(0,o.jsx)("main",{className:"max-w-4xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:(0,o.jsxs)("div",{className:"space-y-6",children:[!d&&(0,o.jsx)("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 rounded-r-lg",children:(0,o.jsxs)("div",{className:"flex",children:[(0,o.jsx)("div",{className:"flex-shrink-0",children:(0,o.jsx)("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),(0,o.jsxs)("div",{className:"ml-3",children:[(0,o.jsx)("h3",{className:"text-sm font-medium text-yellow-800",children:"Finesse n\xe3o detectado"}),(0,o.jsx)("div",{className:"mt-2 text-sm text-yellow-700",children:(0,o.jsx)("p",{children:"O Finesse n\xe3o est\xe1 aberto ou n\xe3o foi detectado. As notifica\xe7\xf5es est\xe3o suspensas at\xe9 que o Finesse seja aberto."})}),(0,o.jsx)("div",{className:"mt-4",children:(0,o.jsx)("div",{className:"-mx-2 -my-1.5 flex",children:(0,o.jsx)("button",{onClick:N.openDocs,className:"bg-yellow-50 px-2 py-1.5 rounded-md text-sm font-medium text-yellow-800 hover:bg-yellow-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-yellow-50 focus:ring-yellow-600",children:"Abrir Finesse"})})})]})]})}),(0,o.jsx)(D,{status:t,isConnected:s,onRefresh:v,isLoading:r}),i&&(0,o.jsx)(R,{currentState:null==t?void 0:null===(e=t.state)||void 0===e?void 0:e.text,onStateChange:x,getReasonCodes:w}),(0,o.jsx)(L,{settings:c,onUpdate:b}),(0,o.jsx)(O,{settings:n,onUpdate:f}),(0,o.jsx)(I,{config:l,onUpdate:p,onTest:y}),a&&(0,o.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:(0,o.jsxs)("div",{className:"flex",children:[(0,o.jsx)("div",{className:"flex-shrink-0",children:(0,o.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,o.jsxs)("div",{className:"ml-3",children:[(0,o.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Erro no sistema"}),(0,o.jsx)("div",{className:"mt-2 text-sm text-red-700",children:(0,o.jsx)("p",{children:a})})]})]})})]})}),(0,o.jsx)("footer",{className:"bg-white border-t border-gray-200 mt-12",children:(0,o.jsx)("div",{className:"max-w-4xl mx-auto py-4 px-4 sm:px-6 lg:px-8",children:(0,o.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[(0,o.jsx)("span",{children:"Por Rafael Arcanjo \xa9 TOTVS"}),(0,o.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,o.jsx)("span",{children:"v2.0.0"}),(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("div",{className:"w-2 h-2 rounded-full mr-2 ".concat(s?"bg-green-500":"bg-red-500")}),(0,o.jsx)("span",{className:"text-xs",children:s?"Conectado":"Desconectado"})]})]})]})})})]}):(0,o.jsx)("div",{className:"min-h-screen bg-gray-100",children:(0,o.jsx)("div",{className:"py-12 px-4 sm:px-6 lg:px-8",children:(0,o.jsx)("div",{className:"max-w-md mx-auto",children:(0,o.jsx)(A,{onLogin:h,isLoading:r,error:a,isAccountLocked:u,remainingAttempts:m})})})})}}},function(e){e.O(0,[447,971,23,744],function(){return e(e.s=160)}),_N_E=e.O()}]);